## Установка и настройка PostgreSQL

**Цель:**

  Cоздавать дополнительный диск для уже существующей виртуальной машины, размечать его и делать на нем файловую систему
переносить содержимое базы данных PostgreSQL на дополнительный диск
переносить содержимое БД PostgreSQL между виртуальными машинами

**Решение:**

### 1. Уже есть виртуальнавя машина, установленная ранее.
...
...
### 2. Устанавливаем на нее PostgreSQL 15
...
...
### 3. Проверяем кластер
sudo -u postgres pg_lsclusters
...
...
### 4. Заходим под пользователем postgres в psql и создаем таблицу с произвольным содержимым
postgres=# create table test(c1 text);
postgres=# insert into test values('задание 3');
...
...
### 5. Останавливаем postgres командой через sudo -u postgres pg_ctlcluster 15 main stop
...
...
### 6. Создаем новый диск к ВМ размером 10GB
...
...
### 7. Добавляем новый диск к вирт. машине
...
...
### 8. Проиницмализируем диск
...
...
### 9. Перезагрузим и проверим диск на месте, примонтирован ли он.
...
...
### 10. Назначим пользователя postgres владельцем /mnt/data - chown -R postgres:postgres /mnt/data/
...
...
### 11. Перенесем содержимое /var/lib/postgres/15 в /mnt/data - mv /var/lib/postgresql/15/mnt/data
...
...
### 12. Попытаемся запустить после данных действий кластер
 sudo -u postgres pg_ctlcluster 15 main start
...
...
### 13. Смотрим результат, да или нет
...
...
### 14. Находим конф. параметр в в файлах раположенных в /etc/postgresql/15/main, который нужно поменять
 и делаем это
...
...
### 15. Попытаемся запустить кластер - sudo -u postgres pg_ctlcluster 15 main start
...
...
### 16. Смотрим результат, да или нет
...
...
### 17. Заходим в БД и смотрим нашу табличку, которую создали до этого
...
...
# задание со звездочкой *: 

### 1. Ставим еще один инстанс  не удаляя существующий инстанс ВМ
...
...
### 2. Удаляем после установки файлы с данными  из /var/lib/postgres
...
...
### 3. Перемонтируем диск от 1-ой ВМ ко 2-ой ВМ
...
...
### 4. запустите PostgreSQL на второй машине так чтобы он работал с данными на внешнем диске.
...
...
### 5. Результат
...
...
